# Visualization Details for VSI-Bench Experiments

**Last Updated:** January 29, 2026  
**Author:** VSI-Bench Project Team

---

## Overview

This document provides comprehensive details about the visualizations generated for the VSI-Bench (Visual Spatial Intelligence Benchmark) experiments, including data sources, plot descriptions, and reproduction instructions.

---

## Data Sources

### Primary Data File
- **Location:** `/dss/dsshome1/06/di38riq/rl_multi_turn/comparison_combined.csv`
- **Generated by:** `analysis/compare_experiments.py`
- **Description:** Aggregated results from all experiments including Sequential and Video methods on 4B and 8B models

### Data Structure
```
Method,Model,Dataset,Frames/Steps,Questions,Accuracy (%),Success Rate (%),Avg Time (s),ARKit Acc (%),ARKit N,ScanNet Acc (%),ScanNet N
```

### Experiment Folders

**Video Method Experiments:**
- **4B Results:**
  - Location: `/dss/dssmcmlfs01/pn34sa/pn34sa-dss-0000/aydemir/experiment_logs/Video/4B/`
  - 32-frame run folders:
    - `20260129_140057_video_Qwen3-VL-4B_combined_32frames_split1of4`
    - `20260129_140051_video_Qwen3-VL-4B_combined_32frames_split2of4`
    - `20260129_140803_video_Qwen3-VL-4B_combined_32frames_split3of4`
    - `20260129_140803_video_Qwen3-VL-4B_combined_32frames_split4of4`
  - Other frame counts: 4, 8, 16 frames

- **8B Results:**
  - Location: `/dss/dssmcmlfs01/pn34sa/pn34sa-dss-0000/aydemir/experiment_logs/Video/8B/`
  - 32-frame run folders:
    - `20260129_140803_video_Qwen3-VL-8B_combined_32frames_split1of4`
    - `20260129_140802_video_Qwen3-VL-8B_combined_32frames_split2of4`
    - `20260129_144020_video_Qwen3-VL-8B_combined_32frames_split3of4`
    - `20260129_144648_video_Qwen3-VL-8B_combined_32frames_split4of4`

**Sequential Method Experiments:**
- Location: `/dss/dssmcmlfs01/pn34sa/pn34sa-dss-0000/aydemir/experiment_logs/Sequential/`
- Organized by model size (4B, 8B) and step counts (16, 32)

### Key Results Summary

| Model | Method     | Frames/Steps | Accuracy (%) | Questions |
|-------|-----------|--------------|--------------|-----------|
| 4B    | Video     | 4            | 38.14%       | 1311      |
| 4B    | Video     | 8            | 42.87%       | 1311      |
| 4B    | Video     | 16           | 48.05%       | 1311      |
| 4B    | Video     | 32           | 40.96%       | 1311      |
| 8B    | Video     | 4            | 38.67%       | 1311      |
| 8B    | Video     | 8            | 42.94%       | 1311      |
| 8B    | Video     | 16           | 47.14%       | 1311      |
| 8B    | Video     | 32           | 44.85%       | 1311      |
| 4B    | Sequential| 16           | 41.14%       | 858       |
| 4B    | Sequential| 32           | 40.91%       | 809       |
| 8B    | Sequential| 16           | 44.26%       | 899       |
| 8B    | Sequential| 32           | 43.66%       | 852       |

---

## Visualization Scripts

### Main Plotting Script
- **Script:** `analysis/plot_results.py`
- **Language:** Python 3
- **Dependencies:** pandas, numpy, matplotlib, seaborn
- **Input:** `comparison_combined.csv`
- **Output Directory:** `figures/`

### Usage
```bash
cd /dss/dsshome1/06/di38riq/rl_multi_turn
python3 analysis/plot_results.py
```

### Options
```bash
python3 analysis/plot_results.py --input comparison_combined.csv --output figures/
python3 analysis/plot_results.py --latex  # Use LaTeX fonts (requires LaTeX)
```

---

## Generated Plots

### 1. Overall Accuracy Comparison
- **File:** `figures/overall_accuracy.pdf` / `.png`
- **Description:** Bar chart comparing best accuracy for each method and model size
- **Plot Type:** Grouped bar chart
- **X-axis:** Method (Sequential, Video)
- **Y-axis:** Accuracy (%)
- **Colors:** 
  - 4B Model: `#229e4a` (Green)
  - 8B Model: `#659df2` (Blue)

### 2. Accuracy vs Frames/Steps
- **File:** `figures/accuracy_vs_frames.pdf` / `.png`
- **Description:** Line plots showing how accuracy changes with number of frames/steps
- **Plot Type:** Two subplots (Sequential left, Video right) with line plots
- **X-axis:** Number of steps/frames (4, 8, 16, 32)
- **Y-axis:** Accuracy (%), scaled to data range
- **Lines:**
  - 4B Model: `#229e4a` (Green)
  - 8B Model: `#659df2` (Blue)
- **Key Insight:** Video method peaks at 16 frames, then decreases at 32 frames

### 3. Method Comparison (4B vs 8B)
- **File:** `figures/method_comparison_4b_vs_8b.pdf` / `.png`
- **Description:** Comparison of Sequential vs Video methods for each model size
- **Plot Type:** Two subplots (4B left, 8B right) with two lines each
- **X-axis:** Number of frames/steps (4, 8, 16, 32)
- **Y-axis:** Accuracy (%), scaled to data range
- **Lines:**
  - Sequential: `#443acf` (Purple)
  - Video: `#bd0a0a` (Red)
- **Key Insight:** Direct comparison showing Video outperforms Sequential at higher frame counts

### 4. Methods by Model
- **File:** `figures/methods_by_model.pdf` / `.png`
- **Description:** Separate comparison for each model showing both methods
- **Plot Type:** Two subplots with line plots
- **Lines:**
  - Sequential: `#443acf` (Purple)
  - Video: `#bd0a0a` (Red)

### 5. Dataset Breakdown
- **File:** `figures/dataset_breakdown.pdf` / `.png`
- **Description:** Performance breakdown by dataset (ARKit vs ScanNet)
- **Plot Type:** Grouped bar chart
- **Shows:** Accuracy differences between ARKitScenes and ScanNet datasets

### 6. Method Comparison Heatmap
- **File:** `figures/method_heatmap.pdf` / `.png`
- **Description:** Heatmap showing accuracy across methods and configurations
- **Plot Type:** Heatmap with color gradient
- **Useful for:** Quick overview of all experiment configurations

### 7. Success Rate vs Accuracy
- **File:** `figures/success_vs_accuracy.pdf` / `.png`
- **Description:** Scatter plot showing relationship between completion rate and accuracy
- **Plot Type:** Scatter plot
- **X-axis:** Success Rate (%)
- **Y-axis:** Accuracy (%)
- **Colors:**
  - Sequential: `#443acf` (Purple)
  - Video: `#bd0a0a` (Red)

### 8. Summary Figure
- **File:** `figures/summary_figure.pdf` / `.png`
- **Description:** Multi-panel figure with overall results, accuracy trends, and success rates
- **Plot Type:** Composite figure with multiple subplots
- **Suitable for:** Papers, presentations, comprehensive overview

---

## Color Scheme

### Custom Colors (January 2026)
```python
COLORS = {
    'method': ['#443acf', '#bd0a0a'],  # Purple (Sequential), Red (Video)
    'model': ['#229e4a', '#659df2'],   # Green (4B), Blue (8B)
    'frames': ['#229e4a', '#443acf', '#bd0a0a', '#659df2'],
}
```

### Color Meanings
- **#229e4a (Green):** 4B Model
- **#443acf (Purple):** Sequential Method
- **#bd0a0a (Red):** Video Method
- **#659df2 (Blue):** 8B Model

---

## Technical Specifications

### Plot Settings
- **DPI:** 600 (high resolution for publication)
- **Figure Size:** 14x5 inches (for side-by-side subplots)
- **Font Family:** Serif (Times New Roman fallback)
- **Font Sizes:**
  - Regular text: 11pt
  - Axis labels: 12pt
  - Titles: 14pt
  - Figure title: 16pt
- **Line Width:** 2.5px (thicker for visibility)
- **Marker Size:** 9pt
- **Grid:** Alpha 0.3 (subtle)

### Y-Axis Scaling
- **Method:** Data-driven range with 15% padding
- **Formula:** `[min_acc - range*0.15, max_acc + range*0.15]`
- **Minimum:** 0% (never goes negative)

### X-Axis
- **Ticks:** Only at actual data points (4, 8, 16, 32)
- **Labels:** Integer values as strings

---

## Data Preprocessing

### CSV Cleanup (January 29, 2026)
```python
# Remove incomplete entries (NaN datasets or models)
df_clean = df[df['Dataset'].notna() & df['Model'].notna()]
```

This removed 7 incomplete rows from failed/partial experiments.

### Frame/Step Number Extraction
```python
def extract_number(frame_step_str):
    import re
    match = re.search(r'(\d+)', str(frame_step_str))
    return int(match.group(1)) if match else None

df['Frames/Steps_Num'] = df['Frames/Steps'].apply(extract_number)
```

---

## Reproduction Instructions

### Full Workflow

1. **Run experiments** (if not already done):
   ```bash
   cd /dss/dsshome1/06/di38riq/rl_multi_turn
   # Video method
   sbatch evaluation/submit_video_baseline.sbatch
   # Sequential method
   sbatch evaluation/submit_sequential_baseline.sbatch
   ```

2. **Aggregate results:**
   ```bash
   python3 analysis/compare_experiments.py \
       --export analysis/results/comparison_combined.csv \
       --export-types analysis/results/by_question_type.csv
   ```

3. **Clean data:**
   ```bash
   # Copy to working directory and remove incomplete entries
   cp analysis/results/comparison_combined.csv .
   python3 -c "
   import pandas as pd
   df = pd.read_csv('comparison_combined.csv')
   df_clean = df[df['Dataset'].notna() & df['Model'].notna()]
   df_clean.to_csv('comparison_combined.csv', index=False)
   "
   ```

4. **Generate plots:**
   ```bash
   python3 analysis/plot_results.py
   ```

5. **View results:**
   ```bash
   ls -lh figures/*.pdf
   ```

### Quick Regeneration
```bash
cd /dss/dsshome1/06/di38riq/rl_multi_turn
python3 analysis/plot_results.py
```

---

## Key Findings

### Video Method
- **Peak Performance:** 16 frames (4B: 48.05%, 8B: 47.14%)
- **Diminishing Returns:** 32 frames shows decreased accuracy
- **Hypothesis:** Model struggles with excessive context or redundant information

### Sequential Method
- **Consistent Performance:** Stable across 16-32 steps (~41-44%)
- **Less Sensitive:** To frame/step count variations

### Model Size Comparison
- **8B Advantage:** Generally 2-4% higher accuracy than 4B
- **Most Significant:** At higher frame counts (16-32)

---

## File Locations Summary

```
/dss/dsshome1/06/di38riq/rl_multi_turn/
├── comparison_combined.csv              # Main data file
├── analysis/
│   ├── compare_experiments.py           # Aggregation script
│   ├── plot_results.py                  # Plotting script
│   └── results/
│       ├── comparison_combined.csv      # Generated aggregated data
│       └── by_question_type.csv         # Per-question-type breakdown
├── figures/                             # Output directory
│   ├── accuracy_vs_frames.pdf
│   ├── method_comparison_4b_vs_8b.pdf
│   ├── methods_by_model.pdf
│   ├── overall_accuracy.pdf
│   ├── dataset_breakdown.pdf
│   ├── method_heatmap.pdf
│   ├── success_vs_accuracy.pdf
│   └── summary_figure.pdf
└── visualization_details/               # This documentation
    └── README.md

/dss/dssmcmlfs01/pn34sa/pn34sa-dss-0000/aydemir/experiment_logs/
├── Video/
│   ├── 4B/                             # 4B video experiments
│   └── 8B/                             # 8B video experiments
└── Sequential/
    ├── 4B/                             # 4B sequential experiments
    └── 8B/                             # 8B sequential experiments
```

---

## Contact & Maintenance

For questions or updates to this documentation, contact the VSI-Bench project team.

**Last verification:** January 29, 2026
